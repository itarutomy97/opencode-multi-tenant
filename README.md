# OpenCode Multi-Tenant API

OpenCode Zen APIã‚’ä½¿ç”¨ã—ãŸãƒãƒ«ãƒãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾å¿œã®AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆAPIã€‚Cloudflare Workers + Hono + Clerk èªè¨¼ + Durable Objects (SQLite) ã§æ§‹ç¯‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¯ ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã§ãã‚‹ã“ã¨

### é–‹ç™ºè€…å‘ã‘
- **âœ… å­¦ç¿’æ•™æ**: Cloudflare Workers + Durable Objects + SQLite ã®å®Ÿè£…ä¾‹ãŒå­¦ã¹ã‚‹
- **âœ… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**: è‡ªåˆ†ã®AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ä½œã‚‹ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ä½¿ãˆã‚‹
- **âœ… å‚è€ƒå®Ÿè£…**: Clerkèªè¨¼ã€ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè¨­è¨ˆã®å‚è€ƒã«ãªã‚‹
- **âœ… ç„¡æ–™ã§å‹•ã**: ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ä¸è¦ã€ã™ãã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦è©¦ã›ã‚‹

### ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘
- **âœ… ç„¡æ–™AIãƒãƒ£ãƒƒãƒˆ**: GLM 4.7 FreeãŒç„¡æ–™ã§ä½¿ãˆã‚‹ï¼ˆæ—¥æœ¬èªå¯¾å¿œï¼‰
- **âœ… ä¼šè©±å±¥æ­´ä¿å­˜**: ãƒãƒ£ãƒƒãƒˆå±¥æ­´ãŒè‡ªå‹•çš„ã«ä¿å­˜ã•ã‚Œã‚‹
- **âœ… APIçµ±åˆ**: Pythonã€JavaScriptã€curlãªã©ã‹ã‚‰ç°¡å˜ã«å‘¼ã³å‡ºã›ã‚‹
- **âœ… ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ãŒå®Œå…¨ã«åˆ†é›¢ã•ã‚Œã¦ã„ã‚‹

## ğŸ¤” ãªãœã“ã‚Œã‚’ä½¿ã†ã¹ãã‹ï¼Ÿ

| ä»–ã®AIãƒãƒ£ãƒƒãƒˆ | OpenCode Multi-Tenant |
|----------------|----------------------|
| æ–™é‡‘ãŒã‹ã‹ã‚‹ | **ç„¡æ–™**ï¼ˆGLM 4.7 Freeï¼‰ |
| å±¥æ­´ãŒæ¶ˆãˆã‚‹ | **å±¥æ­´ãŒä¿å­˜**ã•ã‚Œã‚‹ |
| è‡ªåˆ†ã§ã¯ä½œã‚Œãªã„ | **ã‚³ãƒ¼ãƒ‰ãŒå…¬é–‹**ã•ã‚Œã¦ã„ã‚‹ |
| APIãŒè¤‡é›‘ | **ã‚·ãƒ³ãƒ—ãƒ«ãªREST API** |
| ã‚¤ãƒ³ãƒ•ãƒ©ç®¡ç†ãŒå¿…è¦ | **ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**ã§å‹•ã |

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ

**Web UI**: https://opencode-multi-tenant.tomtar9779.workers.dev

> **âš ï¸ æ‹›å¾…åˆ¶ã§ã™**
> ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯æ‹›å¾…åˆ¶ã§ã™ã€‚ä½¿ç”¨ã™ã‚‹ã«ã¯æ‹›å¾…ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ã€‚
> å‹é”ã«ä½¿ã£ã¦ã‚‚ã‚‰ã†å ´åˆã€æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã¨ä¸€ç·’ã«URLã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

## ğŸ“– ä½¿ã„æ–¹ï¼ˆå‹é”å‘ã‘ï¼‰

### ğŸ‘† 3ã‚¹ãƒ†ãƒƒãƒ—ã§å§‹ã‚ã‚‹ï¼ˆä¸€ç•ªç°¡å˜ï¼‰

```
1ï¸âƒ£ https://opencode-multi-enant.tomtar9779.workers.dev/ ã«ã‚¢ã‚¯ã‚»ã‚¹

2ï¸âƒ£ æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›
    â†’ ä¾‹: FRIENDS-2025

3ï¸âƒ£ ã‚µã‚¤ãƒ³ã‚¤ãƒ³
    â†’ Googleã‹ãƒ¡ãƒ¼ãƒ«ã§ç™»éŒ²ï¼ˆ1åˆ†ã§å®Œäº†ï¼‰

4ï¸âƒ£ ã€ŒGet My Tokenã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    â†’ ãƒˆãƒ¼ã‚¯ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã‚³ãƒ”ãƒ¼
```

### ğŸ”‘ æ‹›å¾…ã‚³ãƒ¼ãƒ‰

æœ‰åŠ¹ãªæ‹›å¾…ã‚³ãƒ¼ãƒ‰ï¼š
- `FRIENDS-2025`
- `TARO-FRIENDS`
- `HANAKO-2025`
- `DEMO-ACCESS`
- `TEST-CODE-2025`
- `EARLY-ADOPTER`
- `BETA-TESTER`
- `INVITE-ONLY`

> ğŸ’¡ æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã‚’ãŠæŒã¡ã§ãªã„å ´åˆã¯ã€ç®¡ç†è€…ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

**ã“ã‚Œã§æº–å‚™å®Œäº†ï¼** ã‚ã¨ã¯ä¸‹ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ã†ã ã‘ã€‚

---

### ğŸ’» Pythonã§ä½¿ã†ï¼ˆä¸€ç•ªäººæ°—ï¼‰

```python
import requests

# Webã‚µã‚¤ãƒˆã§ã‚³ãƒ”ãƒ¼ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘
TOKEN = "ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘"
API_URL = "https://opencode-multi-tenant.tomtar9779.workers.dev"

# ãƒãƒ£ãƒƒãƒˆã‚’é€ä¿¡
response = requests.post(
    f"{API_URL}/api/prompt",
    headers={
        "Authorization": f"Bearer {TOKEN}",
        "Content-Type": "application/json"
    },
    json={"prompt": "ã“ã‚“ã«ã¡ã¯ï¼"}
)

# çµæœã‚’è¡¨ç¤º
print(response.json()["response"])
```

### ğŸŒ JavaScriptã§ä½¿ã†

```javascript
const TOKEN = "ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘";
const API_URL = "https://opencode-multi-tenant.tomtar9779.workers.dev";

const response = await fetch(`${API_URL}/api/prompt`, {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${TOKEN}`,
    "Content-Type": "application/json"
  },
  body: JSON.stringify({ prompt: "ã“ã‚“ã«ã¡ã¯ï¼" })
});

const data = await response.json();
console.log(data.response);
```

### ğŸ“ curlã§ä½¿ã†

```bash
# ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚»ãƒƒãƒˆ
TOKEN="ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘"

# ãƒãƒ£ãƒƒãƒˆã‚’é€ä¿¡
curl -X POST "https://opencode-multi-tenant.tomtar9779.workers.dev/api/prompt" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"prompt": "ã“ã‚“ã«ã¡ã¯ï¼"}'
```

---

### ğŸ”„ ä¼šè©±ã‚’ç¶šã‘ã‚‹å ´åˆ

```python
# 1å›ç›®ï¼šæ–°ã—ã„ãƒãƒ£ãƒƒãƒˆé–‹å§‹
response1 = requests.post(
    f"{API_URL}/api/prompt",
    headers={"Authorization": f"Bearer {TOKEN}", "Content-Type": "application/json"},
    json={"prompt": "ç§ã¯å¤ªéƒã¨è¨€ã„ã¾ã™"}
)
session_id = response1.json()["sessionId"]

# 2å›ç›®ä»¥é™ï¼šä¼šè©±ã‚’ç¶šã‘ã‚‹ï¼ˆsessionIdã‚’ä½¿ã†ï¼‰
response2 = requests.post(
    f"{API_URL}/api/prompt",
    headers={"Authorization": f"Bearer {TOKEN}", "Content-Type": "application/json"},
    json={"prompt": "ç§ã®åå‰ã¯è¦šãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", "sessionId": session_id}
)
print(response2.json()["response"])
# â†’ "ã¯ã„ã€å¤ªéƒã•ã‚“ã§ã™ã­ã€‚"
```

### æ–¹æ³•2: curlã§ä½¿ã†

```bash
# 1. Webã‚µã‚¤ãƒˆã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ï¼ˆä¸Šè¨˜ã®æ‰‹é †1-3ï¼‰
# 2. ãƒˆãƒ¼ã‚¯ãƒ³ã‚’TOKENå¤‰æ•°ã«ã‚»ãƒƒãƒˆ
TOKEN="ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘"

# 3. ãƒãƒ£ãƒƒãƒˆã‚’é€ä¿¡
curl -X POST "https://opencode-multi-tenant.tomtar9779.workers.dev/api/prompt" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"prompt": "ã“ã‚“ã«ã¡ã¯ï¼"}'
```

### æ–¹æ³•3: Pythonã§ä½¿ã†

```python
import requests

# Webã‚µã‚¤ãƒˆã§å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³
TOKEN = "ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘"
API_URL = "https://opencode-multi-tenant.tomtar9779.workers.dev"

# ãƒãƒ£ãƒƒãƒˆã‚’é€ä¿¡
response = requests.post(
    f"{API_URL}/api/prompt",
    headers={
        "Authorization": f"Bearer {TOKEN}",
        "Content-Type": "application/json"
    },
    json={"prompt": "ã“ã‚“ã«ã¡ã¯ï¼"}
)

print(response.json()["response"])
```

### æ–¹æ³•4: JavaScriptã§ä½¿ã†

```javascript
const TOKEN = "ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘";
const API_URL = "https://opencode-multi-tenant.tomtar9779.workers.dev";

// ãƒãƒ£ãƒƒãƒˆã‚’é€ä¿¡
const response = await fetch(`${API_URL}/api/prompt`, {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${TOKEN}`,
    "Content-Type": "application/json"
  },
  body: JSON.stringify({ prompt: "ã“ã‚“ã«ã¡ã¯ï¼" })
});

const data = await response.json();
console.log(data.response);
```

## ğŸ’¬ APIå‘¼ã³å‡ºã—ä¾‹

### æ–°ã—ã„ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹

```bash
TOKEN="ã“ã“ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è²¼ã‚Šä»˜ã‘"

# ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ + æœ€åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
curl -X POST "https://opencode-multi-tenant.tomtar9779.workers.dev/api/prompt" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"prompt": "ç§ã¯å¤ªéƒã¨è¨€ã„ã¾ã™"}'
```

### ç¶šãã®ãƒãƒ£ãƒƒãƒˆï¼ˆä¼šè©±å±¥æ­´ã‚ã‚Šï¼‰

```bash
# ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä½¿ã£ã¦ä¼šè©±ã‚’ç¶šã‘ã‚‹
SESSION_ID="opencode-xxx-xxx"

curl -X POST "https://opencode-multi-tenant.tomtar9779.workers.dev/api/prompt" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"prompt": "ç§ã®åå‰ã¯è¦šãˆã¦ã„ã¾ã™ã‹ï¼Ÿ", "sessionId": "'"$SESSION_ID"'"}'
```

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã‚’è¦‹ã‚‹

```bash
curl "https://opencode-multi-tenant.tomtar9779.workers.dev/api/sessions" \
  -H "Authorization: Bearer $TOKEN"
```

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤

```bash
curl -X DELETE "https://opencode-multi-tenant.tomtar9779.workers.dev/api/sessions/SESSION_ID" \
  -H "Authorization: Bearer $TOKEN"
```

## âœ¨ æ©Ÿèƒ½

- **Clerkèªè¨¼**: ã‚»ã‚­ãƒ¥ã‚¢ãªWebèªè¨¼ï¼ˆJWTãƒˆãƒ¼ã‚¯ãƒ³: 7æ—¥é–“æœ‰åŠ¹ï¼‰
- **Durable Objects with SQLite**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ä¼šè©±å±¥æ­´ã‚’æ°¸ç¶šåŒ–
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®AIã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ†é›¢ç®¡ç†
- **OpenCode Zen APIçµ±åˆ**: GLM 4.7 Freeï¼ˆç„¡æ–™ãƒ¢ãƒ‡ãƒ«ï¼‰
- **ä¼šè©±å±¥æ­´**: éå»ã®ä¼šè©±ã‚’è¦šãˆã¦ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å«ã‚ã‚‹
- **REST API**: Honoãƒ™ãƒ¼ã‚¹ã®é«˜é€ŸAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- **Cloudflare Workers**: ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾å¿œ

## ğŸ› ï¸ é–‹ç™ºè€…å‘ã‘ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### 1. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 2. ç’°å¢ƒå¤‰æ•°è¨­å®š

`.dev.vars` ã¾ãŸã¯ `wrangler.jsonc` ã«ä»¥ä¸‹ã‚’è¨­å®šï¼š

```bash
# OpenCode API
OPENCODE_API_KEY=your-opencode-api-key

# Clerk Authentication
CLERK_SECRET_KEY=sk_test_xxx
CLERK_PUBLISHABLE_KEY=pk_test_xxx
```

### 3. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ï¼ˆCloudflare Workersï¼‰
npm run dev

# åˆ¥ã®ãƒãƒ¼ãƒˆã§èµ·å‹•
npx wrangler dev --port 8788
```

### 4. ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# Cloudflare Workers ã«ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy
```

## ğŸ“Š APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èªè¨¼ | èª¬æ˜ |
|----------|----------------|------|------|
| GET | /health | - | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |
| GET | / | - | Web UIï¼ˆãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ï¼‰ |
| POST | /api/sessions | å¿…é ˆ | ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ |
| GET | /api/sessions | å¿…é ˆ | ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ |
| DELETE | /api/sessions/:id | å¿…é ˆ | ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤ |
| POST | /api/prompt | å¿…é ˆ | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå®Ÿè¡Œ |

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (Browser)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Web UI (Hono + Clerk JS SDK)                                       â”‚   â”‚
â”‚  â”‚  - ã‚µã‚¤ãƒ³ã‚¤ãƒ³ / ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—                                         â”‚   â”‚
â”‚  â”‚  - JWTãƒˆãƒ¼ã‚¯ãƒ³å–å¾— (7æ—¥é–“æœ‰åŠ¹)                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ HTTPS + JWT (Authorizationãƒ˜ãƒƒãƒ€ãƒ¼)
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Cloudflare Workers (Hono)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Auth Middleware (Clerk JWTæ¤œè¨¼)                                    â”‚   â”‚
â”‚  â”‚  - JWTãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ â†’ userIdæŠ½å‡º                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                       â”‚
â”‚                                    â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Protected API Routes (/api/*)                                      â”‚   â”‚
â”‚  â”‚  - POST   /api/sessions      : ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ                        â”‚   â”‚
â”‚  â”‚  - GET    /api/sessions      : ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§                        â”‚   â”‚
â”‚  â”‚  - DELETE /api/sessions/:id   : ã‚»ãƒƒã‚·ãƒ§ãƒ³å‰Šé™¤                        â”‚   â”‚
â”‚  â”‚  - POST   /api/prompt        : ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå®Ÿè¡Œ                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ RPCé€šä¿¡
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SessionDurableObject (SQLite-backed)                     â”‚
â”‚  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ä¼šè©±å±¥æ­´ã‚’æ°¸ç¶šåŒ–                                             â”‚
â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     OpenCode Zen API (GLM 4.7 Free)                       â”‚
â”‚  - æ—¥æœ¬èªå¯¾å¿œ                                                             â”‚
â”‚  - ä¼šè©±å±¥æ­´ã‚’è€ƒæ…®ã—ãŸå¿œç­”                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ç’°å¢ƒå¤‰æ•°

| å¤‰æ•° | èª¬æ˜ | å¿…é ˆ |
|------|------|------|
| `OPENCODE_API_KEY` | OpenCode Zen APIã‚­ãƒ¼ | âœ… |
| `CLERK_SECRET_KEY` | Clerk Secret Key | âœ… |
| `CLERK_PUBLISHABLE_KEY` | Clerk Publishable Key | âœ… |

## â“ ã‚ˆãã‚ã‚‹è³ªå•

### Q: ãƒˆãƒ¼ã‚¯ãƒ³ã®æœ‰åŠ¹æœŸé™ã¯ï¼Ÿ
A: **7æ—¥é–“**ã§ã™ã€‚7æ—¥çµŒã¤ã¨å†åº¦ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### Q: ä»–ã®äººã®ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã¯è¦‹ãˆã‚‹ï¼Ÿ
A: **ã„ã„ãˆ**ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«å®Œå…¨ã«åˆ†é›¢ã•ã‚Œã¦ã„ã¾ã™ã€‚è‡ªåˆ†ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã—ã‹è¦‹ãˆã¾ã›ã‚“ã€‚

### Q: æ–™é‡‘ã¯ã‹ã‹ã‚‹ï¼Ÿ
A: **ç„¡æ–™**ã§ã™ã€‚GLM 4.7 Freeã¨ã„ã†ç„¡æ–™ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

### Q: æ—¥æœ¬èªã¯ä½¿ãˆã‚‹ï¼Ÿ
A: **ã¯ã„**ã€‚GLM 4.7 Freeã¯æ—¥æœ¬èªã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

### Q: ä¼šè©±å±¥æ­´ã¯ã©ã“ã«ä¿å­˜ã•ã‚Œã‚‹ï¼Ÿ
A: Cloudflare Workersã®Durable Objectsï¼ˆSQLiteï¼‰ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

## ğŸ“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### JWTãƒˆãƒ¼ã‚¯ãƒ³ãŒã™ãã«ç„¡åŠ¹ã«ãªã‚‹å ´åˆ

`{ template: 'session' }` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ï¼š

```typescript
// âœ… æ­£ã—ã„ï¼ˆ7æ—¥é–“æœ‰åŠ¹ï¼‰
const token = await clerk.session.getToken({ template: 'session' });

// âŒ é–“é•ã„ï¼ˆ60ç§’ã§ç„¡åŠ¹ï¼‰
const token = await clerk.session.getToken();
```

### ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ©ãƒ¼

1. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã„ã¦ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. Clerkã®ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ£ãƒ–ãƒ«ã‚­ãƒ¼ãŒæ­£ã—ã„ã‹ç¢ºèª
3. Cloudflare Workersã®ãƒ­ã‚°ã‚’ç¢ºèª

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License
